<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Osobní dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main id="dashboard" class="grid"></main>

  <script>
    // seznam widgetů, které chceme načíst
    // každý widget může mít konfiguraci: { name: 'název', width: 'full'|'half'|'third' }
    // nebo jednoduše string pro výchozí šířku
    const widgets = [
      { name: 'header', width: 'full' },
      { name: 'clock', width: 'half' },
      {name: 'ahoj', width: 'full'}

    ];

    async function loadWidgets() {
      const container = document.getElementById('dashboard');
      for (const widgetConfig of widgets) {
        // podpora pro string i objekt
        const widgetName = typeof widgetConfig === 'string'
          ? widgetConfig.trim()
          : widgetConfig.name?.trim();
        const widgetWidth = typeof widgetConfig === 'string'
          ? undefined
          : widgetConfig.width?.trim();

        if (!widgetName) {
          console.warn('Widget bez názvu byl přeskočen.', widgetConfig);
          continue;
        }

        let html;
        try {
          const res = await fetch(`widgets/${widgetName}.html`);
          if (!res.ok) {
            console.warn(`Widget "${widgetName}" se nepodařilo načíst (HTTP ${res.status}).`);
            continue;
          }
          html = await res.text();
        } catch (err) {
          console.error(`Chyba při načítání widgetu "${widgetName}":`, err);
          continue;
        }

        // vytvořit wrapper pro widget
        const widgetWrapper = document.createElement('div');
        widgetWrapper.className = 'widget';
        
        // přidat třídu pro šířku, pokud je specifikována
        if (widgetWidth) {
          widgetWrapper.classList.add(widgetWidth);
        }
        
        widgetWrapper.innerHTML = html;
        container.appendChild(widgetWrapper);
        
        // spustit skripty z widgetu
        const scripts = widgetWrapper.querySelectorAll('script');
        scripts.forEach(oldScript => {
          const newScript = document.createElement('script');
          newScript.textContent = oldScript.textContent;
          oldScript.parentNode.replaceChild(newScript, oldScript);
        });
      }
    }
    loadWidgets();
  </script>
</body>
</html>