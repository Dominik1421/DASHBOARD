<div class="mood-tracker" x-data="moodTracker()">
  <div class="today-mood" x-show="todayMood">
    <p>Dne코n칤 n치lada:</p>
    <div class="mood-display">
      <span class="mood-emoji-large" x-text="getMoodEmoji(todayMood.mood)"></span>
      <span class="mood-label" x-text="getMoodLabel(todayMood.mood)"></span>
    </div>
  </div>

  <div class="mood-selector">
    <p x-show="!todayMood">Jak se dnes c칤t칤코?</p>
    <p x-show="todayMood">Zm캩nit n치ladu:</p>
    <div class="mood-buttons">
      <button class="mood-btn" @click="setMood('happy')" :class="{ 'selected': todayMood && todayMood.mood === 'happy' }" title="먠벼stn칳">游땕</button>
      <button class="mood-btn" @click="setMood('good')" :class="{ 'selected': todayMood && todayMood.mood === 'good' }" title="Dobr칳">游뗵</button>
      <button class="mood-btn" @click="setMood('neutral')" :class="{ 'selected': todayMood && todayMood.mood === 'neutral' }" title="Neutr치ln칤">游땛</button>
      <button class="mood-btn" @click="setMood('sad')" :class="{ 'selected': todayMood && todayMood.mood === 'sad' }" title="Smutn칳">游땩</button>
      <button class="mood-btn" @click="setMood('angry')" :class="{ 'selected': todayMood && todayMood.mood === 'angry' }" title="Na코tvan칳">游</button>
    </div>
  </div>

  <div class="mood-history" x-show="moodHistory.length > 0">
    <p>Historie:</p>
    <div class="history-items">
      <template x-for="(entry, index) in moodHistory.slice(0, 5)" :key="index">
        <div class="history-item">
          <span class="history-date" x-text="formatDate(entry.date)"></span>
          <span class="history-emoji" x-text="getMoodEmoji(entry.mood)"></span>
        </div>
      </template>
    </div>
  </div>
</div>

<script>
function moodTracker() {
  return {
    todayMood: null,
    moodHistory: [],
    
    init() {
      const saved = localStorage.getItem('moodHistory');
      if (saved) this.moodHistory = JSON.parse(saved);
      this.syncToday();
    },
    
    syncToday() {
      const today = this.todayKey();
      const todayEntry = this.moodHistory.find(e => e.date === today);
      if (todayEntry) this.todayMood = todayEntry;
    },
    
    todayKey() {
      return new Date().toISOString().split('T')[0];
    },
    
    setMood(mood) {
      const today = this.todayKey();
      this.moodHistory = this.moodHistory.filter(e => e.date !== today);
      const entry = { date: today, mood };
      this.moodHistory.unshift(entry);
      this.todayMood = entry;
      localStorage.setItem('moodHistory', JSON.stringify(this.moodHistory));
    },
    
    getMoodEmoji(mood) {
      return { happy: '游땕', good: '游뗵', neutral: '游땛', sad: '游땩', angry: '游' }[mood] || '游땛';
    },
    
    getMoodLabel(mood) {
      return { happy: '먠벼stn칳', good: 'Dobr칳', neutral: 'Neutr치ln칤', sad: 'Smutn칳', angry: 'Na코tvan칳' }[mood] || 'Nezn치m칳';
    },
    
    formatDate(dateStr) {
      const date = new Date(dateStr);
      const today = this.todayKey();
      const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
      if (dateStr === today) return 'Dnes';
      if (date.toDateString() === yesterday.toDateString()) return 'V캜era';
      return date.toLocaleDateString('cs-CZ', { day: 'numeric', month: 'short' });
    }
  }
}
</script>

<style>
.mood-tracker { display: flex; flex-direction: column; gap: 1rem; }
.today-mood { text-align: center; padding: 1rem; background: #f0f0f0; border-radius: 8px; }
.mood-display { display: flex; flex-direction: column; align-items: center; gap: 0.5rem; margin-top: 0.5rem; }
.mood-emoji-large { font-size: 3rem; }
.mood-label { font-size: 1.1rem; font-weight: bold; color: #555; }
.mood-selector { text-align: center; }
.mood-selector p { margin: 0 0 0.75rem 0; font-size: 0.9rem; color: #666; }
.mood-buttons { display: flex; justify-content: center; gap: 0.75rem; flex-wrap: wrap; }
.mood-btn { font-size: 2rem; width: 60px; height: 60px; border: 2px solid #ddd; border-radius: 50%; background: white; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
.mood-btn:hover { transform: scale(1.1); border-color: #999; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
.mood-btn.selected { border-color: #4a90e2; background: #e8f4fd; box-shadow: 0 2px 8px rgba(74,144,226,0.3); }
.mood-history { margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid #eee; }
.history-items { display: flex; flex-direction: column; gap: 0.5rem; }
.history-item { display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: #f9f9f9; border-radius: 6px; }
.history-date { font-size: 0.85rem; color: #666; }
.history-emoji { font-size: 1.4rem; }
</style>
